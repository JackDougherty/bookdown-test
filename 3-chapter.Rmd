# Image testing  {#Image}

Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.[@tegelerFindingCommonGround2011]

#### Testing with and without auto_pdf{-}

- Define a text reference for captions, because this method accepts complex syntax, such as RMarkdown cites and links, as shown below. For details, see Bookdown sections on Figures <https://bookdown.org/yihui/bookdown/figures.html> and Markdown extensions <https://bookdown.org/yihui/bookdown/markdown-extensions-by-bookdown.html>.
- Insert a BLANK LINE between the text reference and the R code chunk coming up.
- Insert an R code chunk <https://bookdown.org/yihui/bookdown/r-code.html>, with NO SPACES between ref:chunk-label, as shown below.
- To reduce the width (or height) of the output, add `out.width="30%"` to the code chunk, which works for Web edition and also PDF edition. If width is less than full, also insert `fig.align="center"`.
- To display interactive content in the Web edition and a static image in the PDF edition, create both elements and insert an if-else statement in the R code chunk to display these elements in different outputs, as shown below. (Thanks to Michael Dorman for this tip.)
- If the interactive content includes an iframe (for a map or chart), the default height will be 400 pixels. To adjust the iframe height (or width), insert a line of code in `custom-scripts.html` and add a code comment to the text to serve as a reminder, as shown below. Also, make sure that the `index.Rmd` file includes the custom script in the header, as described in the section above.
- Optional: In the body text, insert a dynamic reference to the figure in the same file, because PDF engine creates floating images that may be placed on the next page. Sample dynamic reference to a figure further below: ... as shown in Figure \@ref(fig:sample-interactive).
- Reminder: If the image appears a second time in the book, in a separate chapter, be sure to relabel the text ref: year-title2.
- Note: Bookdown does not auto-number figures in the `index.Rmd` file, which serves as a preface or introduction.

TODO for final PDF edition:

- About auto_pdf: "include_graphics() can be smart enough to use PDF graphics automatically when the output format is LaTeX and the PDF graphics files exist, e.g., an image path foo/bar.png can be automatically replaced with foo/bar.pdf if the latter exists. PDF images often have better qualities than raster images in LaTeX/PDF output. To make use of this feature, set the argument auto_pdf = TRUE, or set the global option options(knitr.graphics.auto_pdf = TRUE) to enable this feature globally in an R session." from https://bookdown.org/yihui/bookdown/figures.html
- Decide if 'out.width' and 'out.height' is preferable in all cases to `"fig_height=7"`

##### Static image in all editions, WITH auto_pdf, no interactive version{-}
(ref:sample-static-image) Caption for sample static image, with Markdown formatting, links, citation.

```{r sample-static-image, echo=FALSE, fig.cap="(ref:sample-static-image)", auto_pdf= TRUE}
 knitr::include_graphics("images/1937-holc-hartford-map-scan.jpg")
```

##### Same as above, WITHOUT auto_pdf, and out.width for all set to 50%{-}
(ref:sample-static-image2) Caption for sample static image, with Markdown formatting, links, citation.

```{r sample-static-image2, echo=FALSE, out.width="50%", fig.cap="(ref:sample-static-image2)"}
 knitr::include_graphics("images/1937-holc-hartford-map-scan.jpg")
```

Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.[@whittenWestHartfordZoning1924]

##### Interactive iframe in web edition (with adjusted height), static image in PDF edition, WITH auto_pdf{-}
(ref:sample-interactive) Caption for all versions here, with link to [full-screen interactive map with its own caption](https://ontheline.github.io/otl-redlining/index-caption.html), and link to sources and the code  View [map historical sources, known issues, and the code](https://github.com/ontheline/otl-redlining/), developed by Ilya Ilyankou and Jack Dougherty, with footnote (if I can get it to work)

<!-- set iframe 600px height 100% width in custom-scripts.html -->
```{r sample-interactive, echo=FALSE, fig.cap="(ref:sample-interactive)"}
if(knitr::is_html_output()) knitr::include_url("https://ontheline.github.io/otl-redlining/") else knitr::include_graphics("images/1937-otl-redlining.png")
```

##### same as above, WITHOUT auto_pdf{-}
(ref:sample-interactive2) Caption for all versions here, with link to [full-screen interactive map with its own caption](https://ontheline.github.io/otl-redlining/index-caption.html), and link to sources and the code  View [map historical sources, known issues, and the code](https://github.com/ontheline/otl-redlining/), developed by Ilya Ilyankou and Jack Dougherty, with footnote (if I can get it to work)

<!-- set iframe 600px height 100% width in custom-scripts.html -->
```{r sample-interactive2, echo=FALSE, fig.cap="(ref:sample-interactive2)"}
if(knitr::is_html_output()) knitr::include_url("https://ontheline.github.io/otl-redlining/") else knitr::include_graphics("images/1937-otl-redlining.png")
```
